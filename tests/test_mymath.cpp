#include "gravitacek2/mymath.hpp"

#include "gtest/gtest.h"

TEST(elliptic_KE, K)
{
    int n = 10;
    gr2::real eps = 1e-15;

    gr2::real k[] = {0.000000000000000,
                    0.100000000000000,
                    0.200000000000000,
                    0.300000000000000,
                    0.400000000000000,
                    0.500000000000000,
                    0.600000000000000,
                    0.700000000000000,
                    0.800000000000000,
                    0.900000000000000};

    gr2::real K[] = {1.570796326794897,
                    1.574745561517356,
                    1.586867847454166,
                    1.608048619930513,
                    1.639999865864511,
                    1.685750354812596,
                    1.750753802915753,
                    1.845693998374724,
                    1.995302777664730,
                    2.280549138422770};
    
    gr2::real K_val, E_val;
    for (int i = 0; i < n; i++)
    {
        gr2::elliptic_KE(k[i], K_val, E_val, 1e-16);
        EXPECT_NEAR(K[i], K_val, eps);
    }
}

TEST(elliptic_KE, E)
{
    int n = 10;
    gr2::real eps = 1e-15;

    gr2::real k[] = {0.000000000000000,
                    0.100000000000000,
                    0.200000000000000,
                    0.300000000000000,
                    0.400000000000000,
                    0.500000000000000,
                    0.600000000000000,
                    0.700000000000000,
                    0.800000000000000,
                    0.900000000000000};

    gr2::real E[] = {1.570796326794897,
                    1.566861942021668,
                    1.554968546242529,
                    1.534833464923249,
                    1.505941612360040,
                    1.467462209339427,
                    1.418083394448724,
                    1.355661135571955,
                    1.276349943169906,
                    1.171697052781614};

    gr2::real K_val, E_val;
    for (int i = 0; i < n; i++)
    {
        gr2::elliptic_KE(k[i], K_val, E_val, 1e-16);
        EXPECT_NEAR(E[i], E_val, eps);
    }
}

int main(int argc, char **argv)
{
    ::testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
}